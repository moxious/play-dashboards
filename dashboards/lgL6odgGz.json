{"meta":{"type":"db","canSave":false,"canEdit":true,"canAdmin":false,"canStar":false,"canDelete":false,"slug":"synthetic-monitoring-dns","url":"/d/lgL6odgGz/synthetic-monitoring-dns","expires":"0001-01-01T00:00:00Z","created":"2022-07-13T09:52:47Z","updated":"2022-07-13T09:52:47Z","updatedBy":"alexandra.vargas@grafana.com","createdBy":"alexandra.vargas@grafana.com","version":1,"hasAcl":false,"isFolder":false,"folderId":1543,"folderUid":"TQaXSqenk","folderTitle":"Synthetic Monitoring","folderUrl":"/dashboards/f/TQaXSqenk/synthetic-monitoring","provisioned":false,"provisionedExternalId":"","annotationsPermissions":{"dashboard":{"canAdd":true,"canEdit":true,"canDelete":true},"organization":{"canAdd":false,"canEdit":false,"canDelete":false}},"hasPublicDashboard":false,"publicDashboardAccessToken":"","publicDashboardUid":"","publicDashboardEnabled":false},"dashboard":{"__requires":[{"id":"grafana","name":"Grafana","type":"grafana","version":"8.3.3"},{"id":"graph","name":"Graph","type":"panel","version":""},{"id":"logs","name":"Logs","type":"panel","version":""},{"id":"loki","name":"Loki","type":"datasource","version":"1.0.0"},{"id":"prometheus","name":"Prometheus","type":"datasource","version":"1.0.0"},{"id":"stat","name":"Stat","type":"panel","version":""}],"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":false,"gnetId":null,"graphTooltip":0,"id":1546,"iteration":1657562169000,"links":[],"panels":[{"datasource":"grafanacloud-play-prom","description":"What's the error percentage for each probe that is observing the given target.","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"Value":{"index":0,"text":"Error rate"}},"type":"value"}],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"#37872D","value":null},{"color":"#FA6400","value":0.5},{"color":"#C4162A","value":1}]},"unit":"percent"},"overrides":[{"matcher":{"id":"byName","options":"Value"},"properties":[{"id":"displayName","value":"Error rate"}]}]},"gridPos":{"h":9,"w":12,"x":0,"y":0},"id":34,"maxDataPoints":"","options":{"basemap":{"name":"Basemap","type":"default"},"controls":{"mouseWheelZoom":false,"showAttribution":true,"showDebug":false,"showScale":false,"showZoom":true},"layers":[{"config":{"showLegend":false,"style":{"color":{"field":"Value","fixed":"dark-green"},"opacity":0.4,"rotation":{"fixed":0,"max":360,"min":-360,"mode":"mod"},"size":{"field":"Value","fixed":5,"max":10,"min":4},"symbol":{"fixed":"img/icons/marker/circle.svg","mode":"fixed"},"text":{"fixed":"","mode":"field"},"textConfig":{"fontSize":12,"offsetX":0,"offsetY":5,"textAlign":"center","textBaseline":"top"}}},"location":{"geohash":"geohash","latitude":"Value","longitude":"Value","mode":"geohash"},"name":"Layer 1","type":"markers"}],"view":{"id":"zero","lat":0,"lon":0,"zoom":1}},"pluginVersion":"8.3.3","targets":[{"datasource":"grafanacloud-play-prom","exemplar":false,"expr":"100*(\n  1 - (\n    sum by (probe, geohash)\n    (\n      rate(probe_all_success_sum{instance=\"$instance\", job=\"$job\"}[$__range])\n     *\n      on (instance, job, probe, config_version)\n      group_left(geohash)\n      max by (instance, job, probe, config_version, geohash)\n      (\n        sm_check_info{instance=\"$instance\", job=\"$job\"}\n      )\n    )\n    /\n    sum by (probe, geohash)\n    (\n      rate(probe_all_success_count{instance=\"$instance\", job=\"$job\"}[$__range])\n        *\n      on (instance, job, probe, config_version)\n      group_left(geohash)\n      max by (instance, job, probe, config_version, geohash)\n      (\n        sm_check_info{instance=\"$instance\", job=\"$job\"}\n      )\n    )\n  )\n)","format":"table","instant":true,"interval":"","legendFormat":"","refId":"A"}],"title":"Error rate by probe","type":"geomap"},{"cacheTimeout":null,"datasource":"grafanacloud-play-prom","description":"The fraction of time the target was up during the whole period.","fieldConfig":{"defaults":{"decimals":2,"mappings":[{"id":0,"op":"=","text":"N/A","type":1,"value":"null"}],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"#EAB839","value":0.99},{"color":"green","value":0.995}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":2,"w":2,"x":12,"y":0},"id":36,"links":[],"options":{"colorMode":"value","fieldOptions":{"calcs":["lastNotNull"]},"graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"7.5.7","targets":[{"exemplar":true,"expr":"# find the average uptime over the entire time range evaluating 'up' in 5 minute windows\navg_over_time(\n  (\n    # the inner query is going to produce a non-zero value if there was at least one successful check during the 5 minute window\n    # so make it a 1 if there was at least one success and a 0 otherwise\n    ceil(\n      # the number of successes across all probes\n      sum by (instance, job) (increase(probe_all_success_sum{instance=\"$instance\", job=\"$job\"}[5m]))\n      /\n      # the total number of times we checked across all probes\n      (sum by (instance, job) (increase(probe_all_success_count{instance=\"$instance\", job=\"$job\"}[5m])) + 1) # + 1 because we want to make sure it goes to 1, not 2\n    )\n  )\n  [$__range:5m]\n)","hide":false,"instant":true,"interval":"","legendFormat":"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Uptime","type":"stat"},{"cacheTimeout":null,"datasource":"grafanacloud-play-prom","description":"The percentage of all the checks that have succeeded during the whole time period.","fieldConfig":{"defaults":{"decimals":2,"mappings":[{"id":0,"op":"=","text":"N/A","type":1,"value":"null"}],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"#EAB839","value":0.99},{"color":"green","value":0.995}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":2,"w":2,"x":14,"y":0},"id":38,"links":[],"options":{"colorMode":"value","fieldOptions":{"calcs":["lastNotNull"]},"graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"7.5.7","targets":[{"exemplar":true,"expr":"sum(\n  increase(probe_all_success_sum{instance=\"$instance\", job=\"$job\", probe=~\"$probe\"}[$__range])\n   )\n/\nsum(\n  increase(probe_all_success_count{instance=\"$instance\", job=\"$job\", probe=~\"$probe\"}[$__range])\n   )","hide":false,"instant":true,"interval":"","legendFormat":"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Reachability","type":"stat"},{"cacheTimeout":null,"datasource":"grafanacloud-play-prom","description":"The average time to receive an answer across all the checks during the whole time period.","fieldConfig":{"defaults":{"decimals":2,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":1},{"color":"red","value":2}]},"unit":"s"},"overrides":[]},"gridPos":{"h":2,"w":3,"x":16,"y":0},"id":40,"links":[],"options":{"colorMode":"value","fieldOptions":{"calcs":["lastNotNull"]},"graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["last"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"7.5.7","targets":[{"expr":"sum(rate(probe_all_duration_seconds_sum{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"}[$__range]))","hide":false,"instant":true,"interval":"","legendFormat":"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Average latency","type":"stat"},{"cacheTimeout":null,"datasource":"grafanacloud-play-prom","fieldConfig":{"defaults":{"mappings":[{"id":0,"op":"=","text":"N/A","type":1,"value":"null"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":2,"w":3,"x":19,"y":0},"id":32,"links":[],"options":{"colorMode":"value","fieldOptions":{"calcs":["lastNotNull"]},"graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"7.5.7","targets":[{"expr":"avg(probe_dns_answer_rrs{probe=~\"$probe\",instance=\"$instance\", job=\"$job\"})","hide":false,"instant":true,"interval":"","legendFormat":"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Answer Records","type":"stat"},{"datasource":"grafanacloud-play-prom","description":"How often is the target checked?","fieldConfig":{"defaults":{"color":{"fixedColor":"green","mode":"fixed"},"mappings":[],"noValue":"N/A","thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":2,"w":2,"x":22,"y":0},"id":42,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"/^frequency$/","values":false},"text":{},"textMode":"auto"},"pluginVersion":"7.5.7","targets":[{"exemplar":true,"expr":"sum by (frequency) (\n  topk(\n    1,\n    sm_check_info{instance=\"$instance\", job=\"$job\", probe=~\"$probe\"}\n  )\n)","format":"time_series","instant":true,"interval":"","legendFormat":"","queryType":"randomWalk","refId":"A"}],"title":"Frequency","transformations":[{"id":"labelsToFields","options":{}}],"type":"stat"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"grafanacloud-play-prom","description":"","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":10,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":12,"y":2},"hiddenSeries":false,"id":44,"interval":null,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":0,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.7","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"exemplar":true,"expr":"  1 - (\n    sum(\n      rate(probe_all_success_sum{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"}[$__rate_interval])\n        )\n    /\n    sum(\n      rate(probe_all_success_count{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"}[$__rate_interval])\n      )\n  )","hide":false,"interval":"1m","intervalFactor":1,"legendFormat":"errors","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Error Rate : $probe ⮕ $job / $instance","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:254","decimals":null,"format":"percentunit","label":"","logBase":1,"max":"1","min":"0","show":true},{"$$hashKey":"object:255","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"grafanacloud-play-prom","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":10,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":9},"hiddenSeries":false,"id":29,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":false,"linewidth":0,"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.7","pointradius":1,"points":true,"renderer":"flot","repeatDirection":null,"seriesOverrides":[{"alias":"transfer","zindex":3},{"alias":"processing","zindex":2},{"alias":"tls","zindex":1},{"alias":"connect","zindex":0},{"alias":"resolve","zindex":-1}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(probe_dns_duration_seconds{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"}) by (probe)","instant":false,"interval":"","intervalFactor":1,"legendFormat":"{{probe}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Response latency by probe","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"transformations":[],"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:907","decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:908","decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"grafanacloud-play-prom","decimals":0,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":12,"y":9},"hiddenSeries":false,"id":12,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"maxDataPoints":"100","nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.7","pointradius":2,"points":false,"renderer":"flot","repeatDirection":null,"seriesOverrides":[{"alias":"transfer","zindex":3},{"alias":"processing","zindex":2},{"alias":"tls","zindex":1},{"alias":"connect","zindex":0},{"alias":"resolve","zindex":-1}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(probe_dns_answer_rrs{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"})","instant":false,"interval":"","intervalFactor":1,"legendFormat":"Answer Records","refId":"A"},{"expr":"avg(probe_dns_authority_rrs{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"})","instant":false,"interval":"","intervalFactor":1,"legendFormat":"Authority Records","refId":"B"},{"expr":"avg(probe_dns_additional_rrs{probe=~\"$probe\", instance=\"$instance\", job=\"$job\"})","instant":false,"interval":"","intervalFactor":1,"legendFormat":"Additional Records","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Resource records","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"transformations":[],"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:578","decimals":0,"format":"none","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:579","decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"datasource":"grafanacloud-play-logs","fieldConfig":{"defaults":{},"overrides":[]},"gridPos":{"h":13,"w":24,"x":0,"y":16},"id":15,"options":{"dedupStrategy":"none","enableLogDetails":true,"showLabels":true,"showTime":true,"sortOrder":"Descending","wrapLogMessage":true},"targets":[{"expr":"{probe=~\"$probe\", instance=\"$instance\", job=\"$job\", probe_success=\"0\"}","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Error logs for $probe: $instance","type":"logs"}],"refresh":"1m","schemaVersion":27,"style":"dark","tags":["synthetic-monitoring"],"templating":{"list":[{"allValue":".*","current":{},"datasource":"grafanacloud-play-prom","definition":"label_values(sm_check_info{check_name=\"dns\"},probe)","description":null,"error":null,"hide":0,"includeAll":true,"label":null,"multi":false,"name":"probe","options":[],"query":{"query":"label_values(sm_check_info{check_name=\"dns\"},probe)","refId":"grafanacloud-play-prom-probe-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":5,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{},"datasource":"grafanacloud-play-prom","definition":"label_values(sm_check_info{check_name=\"dns\", probe=~\"$probe\"},job)","description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"job","options":[],"query":{"query":"label_values(sm_check_info{check_name=\"dns\", probe=~\"$probe\"},job)","refId":"grafanacloud-play-prom-job-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{},"datasource":"grafanacloud-play-prom","definition":"label_values(sm_check_info{check_name=\"dns\", job=\"$job\", probe=~\"$probe\"},instance)","description":null,"error":null,"hide":0,"includeAll":false,"label":null,"multi":false,"name":"instance","options":[],"query":{"query":"label_values(sm_check_info{check_name=\"dns\", job=\"$job\", probe=~\"$probe\"},instance)","refId":"grafanacloud-play-prom-instance-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":5,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-3h","to":"now"},"timepicker":{"refresh_intervals":["10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"Synthetic Monitoring DNS","uid":"lgL6odgGz","version":1}}