{"meta":{"type":"db","canSave":false,"canEdit":true,"canAdmin":false,"canStar":false,"canDelete":false,"slug":"empty-variables-demo-prometheus","url":"/d/JuH-TUGnk/empty-variables-demo-prometheus","expires":"0001-01-01T00:00:00Z","created":"2021-08-09T15:08:45Z","updated":"2021-08-09T15:34:08Z","updatedBy":"pkolyvas","createdBy":"pkolyvas","version":2,"hasAcl":false,"isFolder":false,"folderId":1166,"folderUid":"-Ybx2UMnk","folderTitle":"Product","folderUrl":"/dashboards/f/-Ybx2UMnk/product","provisioned":false,"provisionedExternalId":"","annotationsPermissions":{"dashboard":{"canAdd":true,"canEdit":true,"canDelete":true},"organization":{"canAdd":false,"canEdit":false,"canDelete":false}},"hasPublicDashboard":false,"publicDashboardAccessToken":"","publicDashboardUid":"","publicDashboardEnabled":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","target":{"limit":100,"matchAny":false,"tags":[],"type":"dashboard"},"type":"dashboard"}]},"description":"Nomad Jobs metrics","editable":true,"gnetId":12787,"graphTooltip":0,"id":1168,"iteration":1628523234844,"links":[],"panels":[{"cacheTimeout":null,"datasource":"Prometheus","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"dtdurations"},"overrides":[]},"gridPos":{"h":4,"w":4,"x":0,"y":0},"id":16,"interval":null,"links":[],"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"8.1.0","targets":[{"alias":"","expr":"max(nomad_client_uptime{instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"}],"title":"Uptime","type":"stat"},{"cacheTimeout":null,"datasource":"Prometheus","fieldConfig":{"defaults":{"color":{"fixedColor":"rgb(31, 120, 193)","mode":"fixed"},"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":4,"w":4,"x":4,"y":0},"id":17,"interval":null,"links":[],"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"area","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"8.1.0","targets":[{"alias":"","expr":"count(sum(nomad_client_allocs_memory_cache) by (exported_job))","format":"time_series","intervalFactor":1,"legendFormat":"","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"}],"title":"Jobs","type":"stat"},{"cacheTimeout":null,"datasource":"Prometheus","fieldConfig":{"defaults":{"color":{"fixedColor":"rgb(31, 120, 193)","mode":"fixed"},"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":4,"w":4,"x":8,"y":0},"id":12,"interval":null,"links":[],"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"area","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"8.1.0","targets":[{"alias":"","expr":"sum(nomad_client_allocations_running{datacenter=\"$datacenter\",instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"}],"title":"Allocs","type":"stat"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":4,"w":12,"x":12,"y":0},"hiddenSeries":false,"id":14,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.1.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"alias":"","expr":"sum(nomad_client_allocations_blocked{datacenter=\"$datacenter\",instance=~\"$instance\"})","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"Blocked","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"},{"expr":"sum(nomad_client_allocations_pending{datacenter=\"$datacenter\",instance=~\"$instance\"})","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"Pending","refId":"B"},{"expr":"sum(nomad_client_allocations_restart{datacenter=\"$datacenter\",instance=~\"$instance\"})","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"Restart ","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Block/Peding/Restart","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"breakPoint":"50%","cacheTimeout":null,"combine":{"label":"Others","threshold":0},"datasource":"Prometheus","fontSize":"80%","format":"decmbytes","gridPos":{"h":9,"w":12,"x":0,"y":4},"id":9,"interval":null,"legend":{"show":true,"values":true},"legendType":"Under graph","links":[],"maxDataPoints":3,"nullPointMode":"connected","pieType":"pie","strokeWidth":1,"targets":[{"alias":"","expr":"sum(nomad_client_unallocated_memory{instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"Available (Free)","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"},{"expr":"sum(nomad_client_allocated_memory{instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"Allocated","refId":"B"}],"title":"Memory","type":"grafana-piechart-panel","valueName":"current"},{"aliasColors":{},"breakPoint":"50%","cacheTimeout":null,"combine":{"label":"Others","threshold":0},"datasource":"Prometheus","fontSize":"80%","format":"none","gridPos":{"h":9,"w":12,"x":12,"y":4},"id":10,"interval":null,"legend":{"show":true,"values":true},"legendType":"Under graph","links":[],"maxDataPoints":3,"nullPointMode":"connected","pieType":"pie","strokeWidth":1,"targets":[{"alias":"","expr":"sum(nomad_client_unallocated_cpu{instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"Available (Free)","rawSql":"SELECT\n  UNIX_TIMESTAMP(\u003ctime_column\u003e) as time_sec,\n  \u003cvalue column\u003e as value,\n  \u003cseries name column\u003e as metric\nFROM \u003ctable name\u003e\nWHERE $__timeFilter(time_column)\nORDER BY \u003ctime_column\u003e ASC\n","refId":"A"},{"expr":"sum(nomad_client_allocated_cpu{instance=~\"$instance\"})","format":"time_series","intervalFactor":1,"legendFormat":"Allocated","refId":"B"}],"title":"CPU (MHz)","type":"grafana-piechart-panel","valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":0,"y":13},"hiddenSeries":false,"id":2,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.1.0","pointradius":5,"points":false,"renderer":"flot","repeat":"host","repeatDirection":"v","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(nomad_client_allocs_cpu_total_percent[5m:10s]) \u003e 1","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{task}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CPU Usage Percent","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":3,"format":"percentunit","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":12,"y":13},"hiddenSeries":false,"id":3,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.1.0","pointradius":5,"points":false,"renderer":"flot","repeat":"host","repeatDirection":"v","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(nomad_client_allocs_cpu_total_ticks{instance=~\"$instance\"}) by(exported_job, task)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{task}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CPU Total Ticks","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":3,"format":"timeticks","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":0,"y":19},"hiddenSeries":false,"id":6,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.1.0","pointradius":5,"points":false,"renderer":"flot","repeat":"host","repeatDirection":"v","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(nomad_client_allocs_memory_rss{instance=~\"$instance\"}) by(exported_job, task)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{task}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"RSS","tooltip":{"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":3,"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":12,"y":19},"hiddenSeries":false,"id":7,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.1.0","pointradius":5,"points":false,"renderer":"flot","repeat":"host","repeatDirection":"v","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(nomad_client_allocs_memory_cache{instance=~\"$instance\"}) by(exported_job, task)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{task}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory Cache","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":3,"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":30,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{},"datasource":"Prometheus","definition":"","description":null,"error":null,"hide":0,"includeAll":false,"label":"DC","multi":false,"name":"datacenter","options":[],"query":{"query":"label_values(nomad_client_uptime, datacenter)","refId":"Prometheus-datacenter-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{},"datasource":"Prometheus","definition":"","description":null,"error":null,"hide":0,"includeAll":true,"label":"Host","multi":true,"name":"instance","options":[],"query":{"query":"label_values(nomad_client_uptime{datacenter=~\"$datacenter\"}, instance)","refId":"Prometheus-instance-Variable-Query"},"refresh":2,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-2w","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Empty Variables Demo - Prometheus","uid":"JuH-TUGnk","version":2}}